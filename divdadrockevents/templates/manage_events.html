{% extends 'base.html' %}
{% block content %}

<div class="row g-3" id="grid">
  <h2>Your Events</h2>
  <!--Event card view-->
  {% for event in events %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="event">
        {% if event.status != 'Cancelled' %}
        <img src="{{event.image}}" alt="Event image"/>
        {%else%}
        <img src="{{event.image}}" alt="Event image" class="opacity-50"/>
        {% endif %}
        <div class="d-flex justify-content-between align-items-center mt-2">
          <h3 class="mb-0">{{event.title}}</h3>
          <span class="badge {{ 'bg-success' if event.status == 'Open' else
                              'bg-secondary' if event.status == 'Sold Out' else
                              'bg-danger' if event.status == 'Cancelled' else
                              'bg-dark' if event.status == 'Inactive'
                            }}">{{event.status}}</span>
        </div>
        <div class="meta">{{event.date}} · {{event.start_time.strftime('%I:%M %p')}} - {{event.end_time.strftime('%I:%M %p')}} · {{event.venue}}</div>
        <div class="meta">Tickets left: {{event.tickets_left}}</div>
        <div class="mt-2">
              {% if event.status != 'Cancelled' %}
              <a href="{{ url_for('events.edit_event', event_id=event.id) }}" class="btn btn-sm btn-primary">Edit</a>
              <form method="POST" action="{{ url_for('events.cancel_event', event_id=event.id) }}"
                style="display:inline;">
                {{ CancelEventForm().hidden_tag() }}
                {{ CancelEventForm().submit(class="btn btn-sm btn-danger", value="Cancel") }}
              </form>
              {% else %}
              <button class="btn btn-sm btn-secondary" disabled>Edit</button>
              <button class="btn btn-sm btn-secondary" disabled>Cancelled</button>
              {% endif %}
        </div>
      </div>
    </div>
  {% endfor %}
</div>
  {% endblock %}